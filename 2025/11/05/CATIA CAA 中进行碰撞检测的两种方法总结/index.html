<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>CATIA CAA中进行碰撞检测的两种方法总结 | 镜中的幽灵小站</title><meta name="author" content="镜中的幽灵"><meta name="copyright" content="镜中的幽灵"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="简介：使用CATIA CAA进行碰撞检测没有官方的文档，相关的接口也无法从DOC文件中找到使用方法，以下是通过尝试和整理总结的在CATIA CAA中进行碰撞检测的方法，包含了需要额外引入的框架和模块。 一、使用 COM（V5Automation）接口进行碰撞检测方法概述通过 COM 接口访问 CATIA 的碰撞检测功能，主要通过获取 CATIAClashes 接口来创建碰撞检测对象，设置检测参数并">
<meta property="og:type" content="article">
<meta property="og:title" content="CATIA CAA中进行碰撞检测的两种方法总结">
<meta property="og:url" content="https://mirror-ghost.netlify.app/2025/11/05/CATIA%20CAA%20%E4%B8%AD%E8%BF%9B%E8%A1%8C%E7%A2%B0%E6%92%9E%E6%A3%80%E6%B5%8B%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/index.html">
<meta property="og:site_name" content="镜中的幽灵小站">
<meta property="og:description" content="简介：使用CATIA CAA进行碰撞检测没有官方的文档，相关的接口也无法从DOC文件中找到使用方法，以下是通过尝试和整理总结的在CATIA CAA中进行碰撞检测的方法，包含了需要额外引入的框架和模块。 一、使用 COM（V5Automation）接口进行碰撞检测方法概述通过 COM 接口访问 CATIA 的碰撞检测功能，主要通过获取 CATIAClashes 接口来创建碰撞检测对象，设置检测参数并">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://mirror-ghost.netlify.app/images/header.jpg">
<meta property="article:published_time" content="2025-11-05T01:17:10.000Z">
<meta property="article:modified_time" content="2025-11-17T03:16:25.288Z">
<meta property="article:author" content="镜中的幽灵">
<meta property="article:tag" content="CAA">
<meta property="article:tag" content="CATIA">
<meta property="article:tag" content="CATIAClash">
<meta property="article:tag" content="CATIA二次开发">
<meta property="article:tag" content="碰撞检测">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://mirror-ghost.netlify.app/images/header.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CATIA CAA中进行碰撞检测的两种方法总结",
  "url": "https://mirror-ghost.netlify.app/2025/11/05/CATIA%20CAA%20%E4%B8%AD%E8%BF%9B%E8%A1%8C%E7%A2%B0%E6%92%9E%E6%A3%80%E6%B5%8B%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/",
  "image": "https://mirror-ghost.netlify.app/images/header.jpg",
  "datePublished": "2025-11-05T01:17:10.000Z",
  "dateModified": "2025-11-17T03:16:25.288Z",
  "author": [
    {
      "@type": "Person",
      "name": "镜中的幽灵",
      "url": "https://mirror-ghost.netlify.app/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://mirror-ghost.netlify.app/2025/11/05/CATIA%20CAA%20%E4%B8%AD%E8%BF%9B%E8%A1%8C%E7%A2%B0%E6%92%9E%E6%A3%80%E6%B5%8B%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CATIA CAA中进行碰撞检测的两种方法总结',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 8.1.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/images/header.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">镜中的幽灵小站</span></a><a class="nav-page-title" href="/"><span class="site-name">CATIA CAA中进行碰撞检测的两种方法总结</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">CATIA CAA中进行碰撞检测的两种方法总结</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-11-05T01:17:10.000Z" title="发表于 2025-11-05 09:17:10">2025-11-05</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-11-17T03:16:25.288Z" title="更新于 2025-11-17 11:16:25">2025-11-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CATIA%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91/">CATIA二次开发</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p><strong><code>简介：使用CATIA CAA进行碰撞检测没有官方的文档，相关的接口也无法从DOC文件中找到使用方法，以下是通过尝试和整理总结的在CATIA CAA中进行碰撞检测的方法，包含了需要额外引入的框架和模块。</code></strong></p>
<h4 id="一、使用-COM（V5Automation）接口进行碰撞检测"><a href="#一、使用-COM（V5Automation）接口进行碰撞检测" class="headerlink" title="一、使用 COM（V5Automation）接口进行碰撞检测"></a>一、使用 COM（V5Automation）接口进行碰撞检测</h4><h5 id="方法概述"><a href="#方法概述" class="headerlink" title="方法概述"></a>方法概述</h5><p>通过 COM 接口访问 CATIA 的碰撞检测功能，主要通过获取 CATIAClashes 接口来创建碰撞检测对象，设置检测参数并执行计算。Automation相关的模块一般以CATIA前缀，区分于CAA的CATI前缀。</p>
<h5 id="代码精简示例"><a href="#代码精简示例" class="headerlink" title="代码精简示例"></a>代码精简示例</h5><p>cpp</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;CATDocumentServices.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;CATIDocRoots.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;CATIProduct.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;CATIAlias.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;CATIAClashes.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;CATIAClash.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;CATIClashResult.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;CATIConflict.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ClashDetectionWithCOM</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    HRESULT hr = E_FAIL;</span><br><span class="line">    CATDocument *pDoc = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 打开CATIA文档</span></span><br><span class="line">    hr = CATDocumentServices::<span class="built_in">OpenDocument</span>(<span class="string">&quot;文件路径&quot;</span>, pDoc);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">FAILED</span>(hr) || !pDoc) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;打开文档失败&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取文档根对象</span></span><br><span class="line">    CATIDocRoots *piDocRootsOnDoc = <span class="literal">NULL</span>;</span><br><span class="line">    hr = pDoc-&gt;<span class="built_in">QueryInterface</span>(IID_CATIDocRoots, (<span class="type">void</span> **)&amp;piDocRootsOnDoc);</span><br><span class="line">    pDoc-&gt;<span class="built_in">Release</span>();</span><br><span class="line">    pDoc = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">FAILED</span>(hr) || !piDocRootsOnDoc) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;获取文档根对象失败&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    CATListValCATBaseUnknown_var *pRootProducts = piDocRootsOnDoc-&gt;<span class="built_in">GiveDocRoots</span>();</span><br><span class="line">    piDocRootsOnDoc-&gt;<span class="built_in">Release</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取根产品</span></span><br><span class="line">    CATIProduct_var spRootProduct = (*pRootProducts)[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">delete</span> pRootProducts;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取碰撞检测接口</span></span><br><span class="line">    CATIAProduct_var spRootPrd = NULL_var;</span><br><span class="line">    hr = spRootProduct-&gt;<span class="built_in">QueryInterface</span>(IID_CATIAProduct, (<span class="type">void</span> **)&amp;spRootPrd);</span><br><span class="line"></span><br><span class="line">    CATBSTR clashesBSTR;</span><br><span class="line">    CATUnicodeString clashesName = <span class="string">&quot;Clashes&quot;</span>;</span><br><span class="line">    clashesName.<span class="built_in">ConvertToBSTR</span>(&amp;clashesBSTR);</span><br><span class="line">    CATBaseDispatch* pBaseDispatch = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="comment">// 获取CATBaseDispatch对象用于转换为CATIAClashes对象</span></span><br><span class="line">    hr = spRootPrd-&gt;<span class="built_in">GetTechnologicalObject</span>(clashesBSTR, pBaseDispatch);</span><br><span class="line">    <span class="built_in">CATFreeString</span>(clashesBSTR);</span><br><span class="line"></span><br><span class="line">    CATIAClashes* pCATIAClashes = <span class="literal">NULL</span>;</span><br><span class="line">    hr = pBaseDispatch-&gt;<span class="built_in">QueryInterface</span>(IID_CATIAClashes, (<span class="type">void</span> **)&amp;pCATIAClashes);</span><br><span class="line">    pBaseDispatch-&gt;<span class="built_in">Release</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建碰撞检测对象</span></span><br><span class="line">    CATIAClash* pCATIAClash = <span class="literal">NULL</span>;</span><br><span class="line">    hr = pCATIAClashes-&gt;<span class="built_in">Add</span>(pCATIAClash);</span><br><span class="line">    pCATIAClashes-&gt;<span class="built_in">Release</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置碰撞检测参数并执行计算，将CATIAClash转换为CATIClash</span></span><br><span class="line">    CATIClash* pClash = <span class="literal">NULL</span>;</span><br><span class="line">    hr = pCATIAClash-&gt;<span class="built_in">QueryInterface</span>(IID_CATIClash, (<span class="type">void</span> **)&amp;pClash);</span><br><span class="line">    pCATIAClash-&gt;<span class="built_in">Release</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化两个检测对象列表，存入CATIProduct对象</span></span><br><span class="line">    CATListValCATBaseUnknown_var list1;</span><br><span class="line">    CATListValCATBaseUnknown_var list2;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">SUCCEEDED</span>(hr) &amp;&amp; pClash) &#123;</span><br><span class="line">        pClash-&gt;<span class="built_in">SetGroupMode</span>(CATGroupModeBetweenTwo);</span><br><span class="line">        <span class="comment">// 设置分组...</span></span><br><span class="line">        pClash-&gt;<span class="built_in">SetGroup</span>(<span class="number">1</span>, list1);</span><br><span class="line">        pClash-&gt;<span class="built_in">SetGroup</span>(<span class="number">2</span>, list2);</span><br><span class="line">        pClash-&gt;<span class="built_in">SetComputationCase</span>(CATComputationCaseClashContact);</span><br><span class="line">        pClash-&gt;<span class="built_in">Compute</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 处理碰撞结果</span></span><br><span class="line">        CATIClashResult* pClashResult = <span class="literal">NULL</span>;</span><br><span class="line">        hr = pClash-&gt;<span class="built_in">GetResult</span>(pClashResult);</span><br><span class="line">        pClash-&gt;<span class="built_in">Release</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">SUCCEEDED</span>(hr) &amp;&amp; pClashResult) &#123;</span><br><span class="line">            <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">            pClashResult-&gt;<span class="built_in">CountConflicts</span>(count);</span><br><span class="line">            <span class="comment">// 遍历碰撞结果...</span></span><br><span class="line">            pClashResult-&gt;<span class="built_in">Release</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="需要引入的头文件"><a href="#需要引入的头文件" class="headerlink" title="需要引入的头文件"></a>需要引入的头文件</h5><ul>
<li><code>CATDocumentServices.h</code>：提供文档操作服务</li>
<li><code>CATIDocRoots.h</code>：用于获取文档根对象</li>
<li><code>CATIProduct.h</code>：产品接口定义</li>
<li><code>CATIAlias.h</code>：产品别名接口</li>
<li><code>CATIAClashes.h</code>：碰撞检测集合接口</li>
<li><code>CATIAClash.h</code>：单个碰撞检测接口</li>
<li><code>CATIClashResult.h</code>：碰撞检测结果接口</li>
<li><code>CATIConflict.h</code>：单个碰撞冲突接口</li>
</ul>
<h5 id="需要额外添加的-Framework-和模块"><a href="#需要额外添加的-Framework-和模块" class="headerlink" title="需要额外添加的 Framework 和模块"></a>需要额外添加的 Framework 和模块</h5><p>Framework：</p>
<ul>
<li><p><code>SpaceAnalysisInterfaces</code>：碰撞检测分析相关接口框架</p>
</li>
<li><p><code>ProductStructureInterfaces</code>: 产品结构相关接口框架</p>
</li>
</ul>
<p>模块：</p>
<ul>
<li><code>CATSaiSpaceAnalysisItf</code>：碰撞检测分析模块</li>
<li><code>ProductStructurePubIDL</code>：产品结构相关自动化接口模块</li>
<li><code>SpaceAnalysisItf</code>：碰撞检测分析自动化接口模块</li>
</ul>
<h4 id="二、使用-CAA-的-CATIClashFactory-进行碰撞检测"><a href="#二、使用-CAA-的-CATIClashFactory-进行碰撞检测" class="headerlink" title="二、使用 CAA 的 CATIClashFactory 进行碰撞检测"></a>二、使用 CAA 的 CATIClashFactory 进行碰撞检测</h4><h5 id="方法概述-1"><a href="#方法概述-1" class="headerlink" title="方法概述"></a>方法概述</h5><p>通过 CAA（Component Application Architecture）框架的 CATIClashFactory 接口创建碰撞检测对象，这种方法更直接地利用 CAA 组件架构，通常用于开发 CATIA 插件或扩展功能。</p>
<h5 id="代码精简示例-1"><a href="#代码精简示例-1" class="headerlink" title="代码精简示例"></a>代码精简示例</h5><p>cpp</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;CATDocumentServices.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;CATIDocRoots.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;CATIProduct.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;CATIAlias.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;CATIClashFactory.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;CATIClash.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;CATIClashResult.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;CATIConflict.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ClashDetectionWithCAAFactory</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    HRESULT hr = E_FAIL;</span><br><span class="line">    CATDocument *pDoc = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 打开CATIA文档</span></span><br><span class="line">    hr = CATDocumentServices::<span class="built_in">OpenDocument</span>(<span class="string">&quot;文件路径&quot;</span>, pDoc);</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">FAILED</span>(hr) || !pDoc) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;打开文档失败&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取CATIClashFactory接口</span></span><br><span class="line">    CATIClashFactory* pClashFactory = <span class="literal">NULL</span>;</span><br><span class="line">    hr = pDoc-&gt;<span class="built_in">QueryInterface</span>(IID_CATIClashFactory, (<span class="type">void</span>**)&amp;pClashFactory);</span><br><span class="line">    pDoc-&gt;<span class="built_in">Release</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">FAILED</span>(hr) || !pClashFactory) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;获取碰撞工厂失败&quot;</span> &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取文档根对象和根产品</span></span><br><span class="line">    CATIDocRoots *piDocRootsOnDoc = <span class="literal">NULL</span>;</span><br><span class="line">    hr = pDoc-&gt;<span class="built_in">QueryInterface</span>(IID_CATIDocRoots, (<span class="type">void</span> **)&amp;piDocRootsOnDoc);</span><br><span class="line">    pDoc-&gt;<span class="built_in">Release</span>();</span><br><span class="line"></span><br><span class="line">    CATListValCATBaseUnknown_var *pRootProducts = piDocRootsOnDoc-&gt;<span class="built_in">GiveDocRoots</span>();</span><br><span class="line">    piDocRootsOnDoc-&gt;<span class="built_in">Release</span>();</span><br><span class="line"></span><br><span class="line">    CATIProduct_var spRootProduct = (*pRootProducts)[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">delete</span> pRootProducts;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化两个检测对象列表，存入CATIProduct对象</span></span><br><span class="line">    CATListValCATBaseUnknown_var list1;</span><br><span class="line">    CATListValCATBaseUnknown_var list2;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 使用CATIClashFactory创建碰撞检测对象</span></span><br><span class="line">    CATIClash* pClash = <span class="literal">NULL</span>;</span><br><span class="line">    pClashFactory-&gt;<span class="built_in">Create</span>(pClash);</span><br><span class="line">    pClashFactory-&gt;<span class="built_in">Release</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 设置碰撞检测参数并执行计算</span></span><br><span class="line">    <span class="keyword">if</span> (pClash) &#123;</span><br><span class="line">        pClash-&gt;<span class="built_in">SetComputationCase</span>(CATComputationCaseClashContact);</span><br><span class="line">        pClash-&gt;<span class="built_in">SetGroupMode</span>(CATGroupModeBetweenTwo);</span><br><span class="line">        <span class="comment">// 设置分组...</span></span><br><span class="line">        pClash-&gt;<span class="built_in">SetGroup</span>(<span class="number">1</span>, list1);</span><br><span class="line">        pClash-&gt;<span class="built_in">SetGroup</span>(<span class="number">2</span>, list2);</span><br><span class="line">        pClash-&gt;<span class="built_in">Compute</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 处理碰撞结果</span></span><br><span class="line">        CATIClashResult* pClashResult = <span class="literal">NULL</span>;</span><br><span class="line">        hr = pClash-&gt;<span class="built_in">GetResult</span>(pClashResult);</span><br><span class="line">        pClash-&gt;<span class="built_in">Release</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="built_in">SUCCEEDED</span>(hr) &amp;&amp; pClashResult) &#123;</span><br><span class="line">            <span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">            pClashResult-&gt;<span class="built_in">CountConflicts</span>(count);</span><br><span class="line">            <span class="comment">// 遍历碰撞结果...</span></span><br><span class="line">            pClashResult-&gt;<span class="built_in">Release</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="需要引入的头文件-1"><a href="#需要引入的头文件-1" class="headerlink" title="需要引入的头文件"></a>需要引入的头文件</h5><ul>
<li><code>CATDocumentServices.h</code>：提供文档操作服务</li>
<li><code>CATIDocRoots.h</code>：用于获取文档根对象</li>
<li><code>CATIProduct.h</code>：产品接口定义</li>
<li><code>CATIAlias.h</code>：产品别名接口</li>
<li><code>CATIClashFactory.h</code>：CAA 碰撞工厂接口</li>
<li><code>CATIClash.h</code>：碰撞检测接口</li>
<li><code>CATIClashResult.h</code>：碰撞检测结果接口</li>
<li><code>CATIConflict.h</code>：单个碰撞冲突接口</li>
</ul>
<h5 id="需要额外添加的-Framework-和模块-1"><a href="#需要额外添加的-Framework-和模块-1" class="headerlink" title="需要额外添加的 Framework 和模块"></a>需要额外添加的 Framework 和模块</h5><p>Framework：</p>
<ul>
<li><code>SpaceAnalysisInterfaces</code>：碰撞检测分析相关接口框架</li>
</ul>
<p>模块：</p>
<ul>
<li><code>CATSaiSpaceAnalysisItf</code>：碰撞检测分析模块</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://mirror-ghost.netlify.app/">镜中的幽灵</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://mirror-ghost.netlify.app/2025/11/05/CATIA%20CAA%20%E4%B8%AD%E8%BF%9B%E8%A1%8C%E7%A2%B0%E6%92%9E%E6%A3%80%E6%B5%8B%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/">https://mirror-ghost.netlify.app/2025/11/05/CATIA CAA 中进行碰撞检测的两种方法总结/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="https://mirror-ghost.netlify.app" target="_blank">镜中的幽灵小站</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CATIA/">CATIA</a><a class="post-meta__tags" href="/tags/CAA/">CAA</a><a class="post-meta__tags" href="/tags/CATIA%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91/">CATIA二次开发</a><a class="post-meta__tags" href="/tags/%E7%A2%B0%E6%92%9E%E6%A3%80%E6%B5%8B/">碰撞检测</a><a class="post-meta__tags" href="/tags/CATIAClash/">CATIAClash</a></div><div class="post-share"><div class="social-share" data-image="/images/header.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/11/05/CATIA%20CAA%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B%E6%96%87%E6%A1%A31/" title="CATIA CAA开发教程文档(1)"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">CATIA CAA开发教程文档(1)</div></div><div class="info-2"><div class="info-item-1">1. 新建项目1.1 创建工作空间（Workspace） 点击 File-&gt;New CAA V5 Workspace     输入工作空间名称（最好以Wsp结尾）  选择Catia版本（V5R18_B18)  点击Next    1.2 创建框架（Framework） 选择Create new generic framework  点击Finish      输入框架名称（以Frm结尾）  选择Implementation  选择Development  点击OK      点击OK      1.3 加载编译环境 点击CAA V5 Workspace  选择Locate Prerequisite Workspace      点击Add  选择CATIA V5R18安装路径  点击OK  点击OK      点击Close     1.4 添加模块（Module） 输入模块名称（M结尾）  选择Shared object  点击OK   点击OK   注：模块文件夹会自动添加.m后缀   1.5 添加命令（Command） 点击File-&gt;Add CAAV5 Ite...</div></div></div></a><a class="pagination-related" href="/2025/11/05/%E2%80%8BCATIA%20V5%20CAA%E5%BC%80%E5%8F%91%E4%B8%ADGetPartNumber%E7%A9%BA%E5%80%BC%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93%E2%80%8B%E2%80%8B/" title="​CATIA V5 CAA开发中`GetPartNumber`空值问题总结"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">​CATIA V5 CAA开发中`GetPartNumber`空值问题总结</div></div><div class="info-2"><div class="info-item-1">​​问题现象​​使用CATIProduct接口时，GetPartNumber返回空值，且GetReference也无效。 ​​原因​​​​高速缓存模式（CGR轻量化加载）​​：  默认启用的高速缓存系统仅加载几何外观，未加载参数和属性数据。  ​​解决方法​​ ​​关闭高速缓存​​  ​​操作​​：工具 &gt; 选项 &gt; 基础结构 &gt; 产品结构 &gt; 高速缓存管理 → ​​取消勾选​​“使用高速缓存系统” → ​​重启CATIA​​。 ​​效果​​：强制完整加载零件数据，GetPartNumber可正确读取。   ​​清理残留缓存文件​​  ​​路径​​：C:\Users\[用户]\AppData\Local\DassaultSystemes\CATCache ​​操作​​：删除缓存文件夹内所有文件。    ​​总结​​关闭高速缓存系统可解决因轻量化加载导致的数据缺失问题，确保CATIProduct接口正常获取零件属性。 </div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/11/05/AddToolbarView%E6%98%AF%E4%BB%80%E4%B9%88/" title="AddToolbarView是什么"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-05</div><div class="info-item-2">AddToolbarView是什么</div></div><div class="info-2"><div class="info-item-1">AddToolbarView是 CATIA 二次开发中的一个函数，它用于将创建的工具条添加到 CATIA 的用户界面中。这个函数允许开发者将自定义的工具条显示在 CATIA 的工作区（workbench）中，使得用户可以直接访问这些工具条。 函数原型AddToolbarView的基本语法如下： 1AddToolbarView(CATCmdContainer* pToolbar, int viewId, int position);   pToolbar：要添加的工具条对象的指针。 viewId：视图的 ID，用于指定在哪个视图中显示工具条。 position：工具条的位置，可以是顶部、底部、左侧或右侧。  参数详解 viewId：这个参数指定了工具条应该显示在哪个视图中。通常，CATIA 中有多个视图，例如主视图、详细信息视图等。视图 ID 是一个整数，用于唯一标识一个视图。 position：这个参数指定了工具条在视图中的位置。可能的值包括： Left：左侧 Right：右侧 Top：顶部 Bottom：底部    示例假设你已经创建了一个工具条pMyToolbar，你想将它添...</div></div></div></a><a class="pagination-related" href="/2025/11/05/CATIGSMFactory/" title="CATIGSMFactory"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-05</div><div class="info-item-2">CATIGSMFactory</div></div><div class="info-2"><div class="info-item-1">CATIGSMFactory是CATIA CAA（Component Application Architecture，组件应用架构）中的一个接口，它提供了创建创成式外形设计（Generative Shape Design，简称GSM）车间所有几何元素的功能。 </div></div></div></a><a class="pagination-related" href="/2025/11/05/CATPathElementAgent/" title="CATPathElementAgent"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-05</div><div class="info-item-2">CATPathElementAgent</div></div><div class="info-2"><div class="info-item-1">‌CATPathElementAgent‌是一个用于获取元素（如点、线、面等）的代理类，属于CAA（CATIA Application Programming Interface）的一部分。它主要用于在CATIA中进行二次开发时，获取和处理设计模型中的几何元素。 功能和用途CATPathElementAgent的主要功能是获取设计模型中的几何元素，并允许开发者对这些元素进行操作。通过该代理类，可以实现对设计模型中元素的查询、选择、修改等操作。例如，可以通过该代理类获取设计模型中的点、线、面等几何元素，并进行相应的处理和分析‌。 创建和使用方法 ‌创建代理类实例‌：首先需要创建一个CATPathElementAgent的实例。 ‌设置选择元素类型‌：通过调用AddElementType方法，设置需要选择或操作的元素类型，例如点、线、面等。 ‌设置行为‌：可以通过调用SetBehavior方法，设置选择元素的行为，例如高亮显示或保持高亮显示等‌。  状态管理在CAA中，状态管理是一个重要的概念。状态可以理解为一个包含多个代理类的容器，当前状态为操作响应状态。通过状态跳转进行切换，以便...</div></div></div></a><a class="pagination-related" href="/2025/11/05/NewAccess%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%8C%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8/" title="NewAccess是什么，如何使用"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-05</div><div class="info-item-2">NewAccess是什么，如何使用</div></div><div class="info-2"><div class="info-item-1">NewAccess是 CATIA 二次开发中用于创建和访问 CATIA 对象的一个宏，它是 CAA（Component Application Architecture）编程环境中的一部分。NewAccess宏用于创建和初始化 CAA 框架中的对象，它通过 CAA 的宏机制简化了对象的创建和访问过程。 使用方法NewAccess的基本语法如下： 1NewAccess(ObjectType, objectName, objectAlias);   ObjectType：要创建的对象类型。 objectName：对象的名称，这个名称在代码中用于访问该对象。 objectAlias：对象的别名，通常用于在 CATIA 的用户界面中显示。  示例假设你想创建一个CATCmdStarter类型的对象，可以这样使用NewAccess： 1NewAccess(CATCmdStarter, pMyCommand, MyCommand);  这里，CATCmdStarter是对象类型，pMyCommand是在代码中用来访问这个对象的名称，MyCommand是这个命令的别名，它可能会在用户界面中显示...</div></div></div></a><a class="pagination-related" href="/2025/11/05/SetAccessChild%E4%B8%8ESetAccessNext%E5%88%86%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%8C%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB/" title="SetAccessChild与SetAccessNext分别是什么，有什么区别"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-05</div><div class="info-item-2">SetAccessChild与SetAccessNext分别是什么，有什么区别</div></div><div class="info-2"><div class="info-item-1">在 CATIA 二次开发中，SetAccessChild和SetAccessNext是两个用于构建用户界面元素（如工具条和菜单）的宏命令，它们用于添加和组织这些元素中的项目。这两个宏的主要区别在于它们在用户界面元素中的插入方式和位置。 SetAccessChildSetAccessChild宏用于将一个对象（如按钮、菜单项等）添加为另一个对象（如工具条、菜单等）的直接子项。这意味着使用SetAccessChild添加的对象会成为父对象的第一个子项。 语法示例： 1SetAccessChild(parentObjectName, childObjectName);   parentObjectName：父对象的名称。 childObjectName：要添加为子项的对象的名称。  SetAccessNextSetAccessNext宏用于在已存在的项目之后插入一个新项目。它将一个对象添加到另一个对象之后，作为下一个兄弟项。 语法示例： 1SetAccessNext(previousObjectName, nextObjectName);   previousObjectName：已存...</div></div></div></a><a class="pagination-related" href="/2025/11/05/%E5%87%A0%E4%B8%AA%E4%B8%8D%E5%90%8C%E7%9A%84Container/" title="几个不同的Container"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-11-05</div><div class="info-item-2">几个不同的Container</div></div><div class="info-2"><div class="info-item-1">Container是包含Catia不同对象的容器，可以通过Document获取，主要分为三类，不同的Container下可以通过不同的Factory创建不同的对象 BRepContainer获取方法： GetBRepContainer() 获取对象： 主要为视窗中可选取的对象  BRepAccess：视窗可选择对象  MechanicalContainer获取方法： GetSpecContainer() 获取对象： 主要是树结构中的对象  MechanicalPart：零件特征  Pad：凸台  GSMTool：几何特征（点线面）  …   CGMContainer获取方法： GetResultContainer() 获取对象： 不可以直接选取的对象  Topological object：拓扑对象  </div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/images/header.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">镜中的幽灵</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">14</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">10</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Karze"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的小站！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E4%BD%BF%E7%94%A8-COM%EF%BC%88V5Automation%EF%BC%89%E6%8E%A5%E5%8F%A3%E8%BF%9B%E8%A1%8C%E7%A2%B0%E6%92%9E%E6%A3%80%E6%B5%8B"><span class="toc-number">1.</span> <span class="toc-text">一、使用 COM（V5Automation）接口进行碰撞检测</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.</span> <span class="toc-text">方法概述</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E7%B2%BE%E7%AE%80%E7%A4%BA%E4%BE%8B"><span class="toc-number">1.2.</span> <span class="toc-text">代码精简示例</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E8%A6%81%E5%BC%95%E5%85%A5%E7%9A%84%E5%A4%B4%E6%96%87%E4%BB%B6"><span class="toc-number">1.3.</span> <span class="toc-text">需要引入的头文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E8%A6%81%E9%A2%9D%E5%A4%96%E6%B7%BB%E5%8A%A0%E7%9A%84-Framework-%E5%92%8C%E6%A8%A1%E5%9D%97"><span class="toc-number">1.4.</span> <span class="toc-text">需要额外添加的 Framework 和模块</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E4%BD%BF%E7%94%A8-CAA-%E7%9A%84-CATIClashFactory-%E8%BF%9B%E8%A1%8C%E7%A2%B0%E6%92%9E%E6%A3%80%E6%B5%8B"><span class="toc-number">2.</span> <span class="toc-text">二、使用 CAA 的 CATIClashFactory 进行碰撞检测</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%95%E6%A6%82%E8%BF%B0-1"><span class="toc-number">2.1.</span> <span class="toc-text">方法概述</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E7%B2%BE%E7%AE%80%E7%A4%BA%E4%BE%8B-1"><span class="toc-number">2.2.</span> <span class="toc-text">代码精简示例</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E8%A6%81%E5%BC%95%E5%85%A5%E7%9A%84%E5%A4%B4%E6%96%87%E4%BB%B6-1"><span class="toc-number">2.3.</span> <span class="toc-text">需要引入的头文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%9C%80%E8%A6%81%E9%A2%9D%E5%A4%96%E6%B7%BB%E5%8A%A0%E7%9A%84-Framework-%E5%92%8C%E6%A8%A1%E5%9D%97-1"><span class="toc-number">2.4.</span> <span class="toc-text">需要额外添加的 Framework 和模块</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/30/OpenCascade%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9A%E9%85%8D%E7%BD%AEVTK/" title="OpenCascade学习笔记：配置VTK">OpenCascade学习笔记：配置VTK</a><time datetime="2025-12-30T04:09:10.000Z" title="发表于 2025-12-30 12:09:10">2025-12-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/30/OpenCascade%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%9AOCC%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AE/" title="OpenCascade学习笔记：OCC下载安装和配置">OpenCascade学习笔记：OCC下载安装和配置</a><time datetime="2025-12-30T03:09:10.000Z" title="发表于 2025-12-30 11:09:10">2025-12-30</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/17/CATPathElementAgent%20%E8%AF%A6%E7%BB%86%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/" title="CATPathElementAgent 详细使用指南">CATPathElementAgent 详细使用指南</a><time datetime="2025-11-17T03:15:10.000Z" title="发表于 2025-11-17 11:15:10">2025-11-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/13/CATIA%20CAA%E5%AF%B9%E8%AF%9D%E6%A1%86%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/" title="CATIA CAA 对话框基本使用指南">CATIA CAA 对话框基本使用指南</a><time datetime="2025-11-13T02:47:10.000Z" title="发表于 2025-11-13 10:47:10">2025-11-13</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/11/05/CATIA%20CAA%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B%E6%96%87%E6%A1%A31/" title="CATIA CAA开发教程文档(1)">CATIA CAA开发教程文档(1)</a><time datetime="2025-11-05T01:26:10.000Z" title="发表于 2025-11-05 09:26:10">2025-11-05</time></div></div></div></div></div></div></main><footer id="footer"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By 镜中的幽灵</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.1</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.1"></script><script src="/js/main.js?v=5.5.1"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>